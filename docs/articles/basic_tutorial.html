<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic Tutorial • SIMPLEGEN</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Basic Tutorial">
<meta property="og:description" content="SIMPLEGEN">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SIMPLEGEN</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/basic_tutorial.html">Basic tutorial</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/model_description.html">The inbuilt epidemiological model</a>
    </li>
    <li>
      <a href="../articles/transmission_record.html">The transmission record</a>
    </li>
    <li>
      <a href="../articles/simulating_relatedness.html">Simulating relatedness</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/SIMPLEGEN">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="basic_tutorial_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic Tutorial</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/SIMPLEGEN/blob/master/vignettes/basic_tutorial.Rmd"><code>vignettes/basic_tutorial.Rmd</code></a></small>
      <div class="hidden name"><code>basic_tutorial.Rmd</code></div>

    </div>

    
    
<p>This tutorial goes through the basic process of creating a SIMPLEGEN project and running the inbuilt epidemiological simulator.</p>
<div id="running-a-basic-simulation" class="section level3">
<h3 class="hasAnchor">
<a href="#running-a-basic-simulation" class="anchor"></a>Running a basic simulation</h3>
<p>SIMPLEGEN works with projects, which are essentially just lists that hold all inputs and outputs in a single convenient place. We start by creating a new project and specifying the parameters of the epidemiological model - see <code><a href="../reference/define_epi_params.html">?define_epi_params</a></code> for a complete list of model parameters and default values.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myproj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simplegen_project.html">simplegen_project</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">myproj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_epi_params.html">define_epi_params</a></span><span class="op">(</span><span class="va">myproj</span>,
                            H <span class="op">=</span> <span class="fl">1e3</span>,
                            M <span class="op">=</span> <span class="fl">1e4</span><span class="op">)</span></code></pre></div>
<p>Alternatively, if you are familiar with the pipe operator <code><a href="../reference/%&gt;%.html">%&gt;%</a></code> from the <code>dplyr</code> package then you can use this to chain together multiple commands:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="va">myproj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simplegen_project.html">simplegen_project</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/define_epi_params.html">define_epi_params</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Taking a quick look at our project we will see a summary of the current setup:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myproj</span>
<span class="co">#&gt; Epidemiological model:</span>
<span class="co">#&gt;   demes: 1</span>
<span class="co">#&gt;   H:  1000</span>
<span class="co">#&gt;   M:  10000</span>
<span class="co">#&gt;   seed infections: 100</span></code></pre></div>
<p>A good way of sanity-checking our model before running simulations is to use some of the inbuilt plotting functions to explore our assumed distributions. For example, we can look at the assumed distribution of time in the acute state as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_epi_distribution.html">plot_epi_distribution</a></span><span class="op">(</span><span class="va">myproj</span>, name <span class="op">=</span> <span class="st">"duration_acute"</span><span class="op">)</span></code></pre></div>
<p><img src="basic_tutorial_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Once we are happy with our assumptions we are ready to run the epidemiological simulation. Note that the argument <code>pb_markdown = TRUE</code> is used here just to avoid cluttering this tutorial with too much output, but you should run the model without this argument.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>myproj &lt;-<span class="st"> </span><span class="kw">sim_epi</span>(myproj, <span class="dt">pb_markdown =</span> <span class="ot">TRUE</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#&gt; Running simulation</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt; </span></span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="op">|</span><span class="st">                                                                            </span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt; </span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt; completed in 0.030627 seconds</span></span></code></pre></div>
<p>Looking at the project again we now see that we have some results:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myproj</span>
<span class="co">#&gt; Epidemiological model:</span>
<span class="co">#&gt;   demes: 1</span>
<span class="co">#&gt;   H:  1000</span>
<span class="co">#&gt;   M:  10000</span>
<span class="co">#&gt;   seed infections: 100</span></code></pre></div>
<p>There are custom functions within SIMPLEGEN for exploring model output (see below), or we can dig into the output manually using the <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code> symbol, for example <code>myproj$epi_output$daily_values</code>.</p>
</div>
<div id="plotting-results" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-results" class="anchor"></a>Plotting results</h3>
<p>One of the most basic plots that we might be interested in is the daily number of hosts in each state. We can specify the states that we want to plot as an input vector:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_daily_states.html">plot_daily_states</a></span><span class="op">(</span><span class="va">myproj</span>, states <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"P"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="basic_tutorial_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>This is also true of mosquito states, which are suffixed with “v”:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_daily_states.html">plot_daily_states</a></span><span class="op">(</span><span class="va">myproj</span>, states <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ev"</span>, <span class="st">"Iv"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="basic_tutorial_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>In addition to storing daily counts in each state, the <code><a href="../reference/sim_epi.html">sim_epi()</a></code> function takes a slice of the population at various times, allowing us to plot age-distributions at these points in time. The sampling times are specified by the argument <code>output_age_times</code>, which defaults to the final timepoint only. Hence, we can plot:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_age_states.html">plot_age_states</a></span><span class="op">(</span><span class="va">myproj</span>, state <span class="op">=</span> <span class="st">"C"</span><span class="op">)</span></code></pre></div>
<p><img src="basic_tutorial_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div id="multiple-demes-and-migration" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-demes-and-migration" class="anchor"></a>Multiple demes and migration</h3>
<p>SIMPLEGEN allows for multiple sub-populations (demes), which can be perfectly isolated or connected by migration. First, we specify the human and mosquito population sizes in each deme by using a vector of values for <code>H</code>, <code>M</code>, and <code>seed_infections</code>. Second, we specify a migration matrix giving the daily probability of each human moving from the source deme (rows) to the destination deme (columns).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># define parameters over multiple demes</span>
<span class="va">n_demes</span> <span class="op">&lt;-</span> <span class="fl">3</span>
<span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1e3</span>, <span class="va">n_demes</span><span class="op">)</span>
<span class="va">seed_infections</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1e2</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>
<span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1e3</span>, <span class="fl">2e3</span>, <span class="fl">3e3</span><span class="op">)</span>

<span class="co"># define a migration matrix</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">0.01</span>
<span class="va">mig_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">m</span> <span class="op">/</span> <span class="va">n_demes</span>, <span class="va">n_demes</span>, <span class="va">n_demes</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">m</span>, <span class="va">n_demes</span><span class="op">)</span>

<span class="co"># load new paramters into the model</span>
<span class="va">myproj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_epi_params.html">define_epi_params</a></span><span class="op">(</span><span class="va">myproj</span>,
                            H <span class="op">=</span> <span class="va">H</span>,
                            seed_infections <span class="op">=</span> <span class="va">seed_infections</span>,
                            M <span class="op">=</span> <span class="va">M</span>,
                            mig_mat <span class="op">=</span> <span class="va">mig_mat</span><span class="op">)</span></code></pre></div>
<p>We then run the simulation as normal:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>myproj &lt;-<span class="st"> </span><span class="kw">sim_epi</span>(myproj, <span class="dt">pb_markdown =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">#&gt; Running simulation</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#&gt; </span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="op">|</span><span class="st">                                                                            </span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#&gt; </span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#&gt; completed in 0.088546 seconds</span></span></code></pre></div>
<p>Now when plotting results we can use the <code>deme</code> argument to specify which deme to plot:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_daily_states.html">plot_daily_states</a></span><span class="op">(</span><span class="va">myproj</span>, states <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"P"</span><span class="op">)</span>, deme <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="basic_tutorial_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_daily_states.html">plot_daily_states</a></span><span class="op">(</span><span class="va">myproj</span>, states <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"P"</span><span class="op">)</span>, deme <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="basic_tutorial_files/figure-html/unnamed-chunk-14-2.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_daily_states.html">plot_daily_states</a></span><span class="op">(</span><span class="va">myproj</span>, states <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"P"</span><span class="op">)</span>, deme <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="basic_tutorial_files/figure-html/unnamed-chunk-14-3.png" width="700"></p>
<p>In the example above there are three demes, with only the first containing infected hosts initially. As time progresses we see infections seed into the other two demes via migration.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Bob Verity, Sophie Berube, Daniel Larremore.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
