<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The inbuilt transmission model • SIMPLEGEN</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="The inbuilt transmission model">
<meta property="og:description" content="SIMPLEGEN">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SIMPLEGEN</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Get started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Simulating malaria transmission</li>
    <li>
      <a href="../404.html">A simple model</a>
    </li>
    <li>
      <a href="../404.html">Sampling from the population</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Overlaying genetics</li>
    <li>
      <a href="../404.html">Pruning the transmission record</a>
    </li>
    <li>
      <a href="../404.html">Pedigrees and relatedness</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    The pipeline
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../404.html">What is the SIMPLEGEN pipeline?</a>
    </li>
    <li>
      <a href="../articles/transmission_record.html">The transmission record</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Models and calibration
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Overall approach</li>
    <li>
      <a href="../articles/calibration_approach.html">Model development and calibration</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Transmission models</li>
    <li>
      <a href="../articles/model_description.html">The inbuilt transmission model</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Calibration</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/calibration_prev_inc.html">Prevalence, incidence and EIR</a>
        </li>
        <li>
          <a href="../articles/calibration_diagnostics.html">Diagnostics</a>
        </li>
        <li>
          <a href="../articles/calibration_age_inc.html">Age-incidence</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-header">Genetic models</li>
    <li>
      <a href="../404.html">TODO - description</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Calibration</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../404.html">TODO - genetic calibration</a>
        </li>
      </ul>
</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Epidemiological data</li>
    <li>
      <a href="../articles/data_prev_inc.html">Prevalence, incidence and EIR</a>
    </li>
    <li>
      <a href="../articles/data_diagnostics.html">Diagnostic sensitivity</a>
    </li>
    <li>
      <a href="../articles/data_age_inc.html">Age-incidence</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Genetic data</li>
    <li>
      <a href="../404.html">Complexity of infection</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Misc
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/SLiM_review.html">Integrating with SLiM</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/SIMPLEGEN" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The inbuilt transmission model</h1>
                        <h4 data-toc-skip class="author">Bob Verity</h4>
            
            <h4 data-toc-skip class="date">2023-03-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/SIMPLEGEN/blob/HEAD/vignettes/model_description.Rmd" class="external-link"><code>vignettes/model_description.Rmd</code></a></small>
      <div class="hidden name"><code>model_description.Rmd</code></div>

    </div>

    
    
<!---
Set the font size of figure captions
Currently not used because figures inserted with html method
-->
<style>
p.caption {
  font-size: 0.9em;
}
</style>
<p>The first step in the SIMPLEGEN pipeline is to simulate from an
epidemiological transmission model. Any model can be used as long as it
can produce output in the required format (described in <a href="https://mrc-ide.github.io/SIMPLEGEN/articles/transmission_record.html" class="external-link">the
next vignette</a>), but an inbuilt transmission model is included with
the pipeline to make life easier. The inbuilt model is designed to be as
simple as possible but no simpler. It does not attempt to be a complete
phenomenological description of the malaria life cycle - rather it is a
cartoon that tries to capture some of the key relationships that we tend
to see in real data.</p>
<p>This vignette gives a high-level description of the inbuilt
transmission model, including some of the key assumptions. For details
on how to run this model, see <a href="https://mrc-ide.github.io/SIMPLEGEN/articles/getting_started.html" class="external-link">this
vignette</a>.</p>
<div class="section level3">
<h3 id="infections-and-host-states">Infections and host states<a class="anchor" aria-label="anchor" href="#infections-and-host-states"></a>
</h3>
<p>The model works by tracking individual infections. Each host within
the model can be thought of having multiple infection “slots”, and each
new infection falls into a new slot. There are a finite number of slots
available per host, defined by <code>max_infections</code>, but most of
the time we can set this number to be large enough that hosts never
saturate all their slots.</p>
<p>Each infection can be thought of as an independent episode of malaria
that goes through the following stages:</p>
<ol style="list-style-type: decimal">
<li>latent (liver stage) infection</li>
<li>acute blood-stage</li>
<li>chronic blood-stage</li>
<li>clearance</li>
</ol>
<p>Infections can pass through all four stages in order, or they can
skip over the acute or chronic stages depending on the model parameters
(see <strong>Figure 4</strong>). The acute stage essentially represents
the symptomatic stage of infection, although the word “acute” has been
used rather than “symptomatic” to avoid forcing a clinical
interpretation on the model. The chronic stage is designed to capture
long-lasting infections, including possible asymptomatic and/or
sub-patent stages (more on detection later).</p>
<p>The state of a host is defined using the decision tree in
<strong>Figure 1</strong>.</p>
<img src="https://raw.githubusercontent.com/mrc-ide/SIMPLEGEN/develop/R_ignore/images/host_decision_tree.png" width="323" height="447"><font size="2">
<figcaption><strong>Figure 1</strong> Decision tree showing how the state of a host
is decided.
</figcaption><p></p></font>
<p>Unless the host has recently received treatment (and so is in the
prophylactic stage) the state of the host is dictated by the states of
the infections it carries. This can be seen in <strong>Figure
2</strong>, which shows the host state for a simple case of two
overlapping infections</p>
<img src="https://raw.githubusercontent.com/mrc-ide/SIMPLEGEN/develop/R_ignore/images/progression1.png"><font size="2">
<figcaption><strong>Figure 2</strong> The host carries two infections (horizontal
boxes), each of which goes through a latent stage and acute and chronic
stages before clearing naturally. The host state is dictated from the
infection states.
</figcaption><p></p></font>
<p>The only host state that is not dictated directly from its infections
is the treated (aka prophylactic) state. Treatment is described fully in
a later section, but in simple terms treatment causes all blood-stage
infections to clear immediately. Liver-stage infections are not cleared,
i.e. treatment does not represent a radical cure. After treatment, the
host enters a prophylactic state in which new liver-stage infections can
occur, but any infections leaving the liver within the prophylactic
period are immediately cured. Eventually the prophylaxis wears off and
the host transitions back into the susceptible or exposed state.
<strong>Figure 3</strong> shows a second example of host states, this
time for a more complex case involving treatment and prophylaxis.</p>
<img src="https://raw.githubusercontent.com/mrc-ide/SIMPLEGEN/develop/R_ignore/images/progression2.png"><font size="2">
<figcaption><strong>Figure 3</strong> The host acquires two infections, and later
receives treatment and enters a prophylactic state. During this
prophylactic period a new liver-stage infection takes hold, but this
leaves the liver within the prophylactic period and is therefore
immediately cured. A second liver-stage infection occurs within the
prophylactic period, but this one leaves the liver outside the
prophylactic period and so proceeds as normal.
</figcaption><p></p></font>
<p>Given the description above, we can now visualise the model in a
classical compartmental structure. <strong>Figure 4</strong> shows the
possible states and transitions of both infections and hosts.</p>
<img src="https://raw.githubusercontent.com/mrc-ide/SIMPLEGEN/develop/R_ignore/images/model_diagram_inoc&amp;host.png"><font size="2">
<figcaption><strong>Figure 4</strong> Infection states and host states. Dashed
arrows indicate transitions that are only possible via super-infection.
</figcaption><p></p></font>
<p>Notice there are no rates or parameters on any of the arrows in
<strong>Figure 4</strong>. This is because state durations and
transition probabilities are modelled using flexible distributions
rather than fixed parameter values.</p>
</div>
<div class="section level3">
<h3 id="flexible-distributions">Flexible distributions<a class="anchor" aria-label="anchor" href="#flexible-distributions"></a>
</h3>
<p>There are two elements that describe how infections move between
states - duration distributions and transition probabilities. Duration
distributions dictate the probability that an infection leaves a given
state on each day since entering that state. Once it is decided that an
infection will leave a state, transition probabilities dictate the
chance of moving to each possible destination state.</p>
<p>Both duration distributions and transition probabilities can be
defined in a flexible way, giving fine control over how infections move
between states. Duration distributions can be input as a vector of daily
probabilities, and then durations within the model are obtained by
sampling from this vector. Alternatively, the user can input a list of
vectors, in which case the first element applies the first time the host
is exposed to an infection, the second element the second time, and so
on. Once we reach the final element in the list, this applies for all
subsequent infections. Similarly, transition probabilities can be
defined as a single value, or as a vector of values in which case the
first value applies to the first exposure, the second value to the
second exposure, and so on. By varying these inputs we can capture some
fairly detailed patterns within quite a simple model. For example, we
could arrive at a simple exposure-driven immunity model by setting up
distributions such that subsequent infections are more likely to be
chronic, and/or last longer.</p>
<p>Finally, there are some daily probabilities that can be defined in a
flexible way, for example the daily probability of being detected by
microscopy following infection. These differ from duration distributions
in that they do not need to sum to one, rather they give a probability
between 0 and 1 on each day. These can also be defined as either a
vector or a list of vectors that increment with exposure.</p>
<p>Here is a complete list of parameters that can be defined in a
flexible way:</p>
<div class="section level4">
<h4 id="duration-distributions">duration distributions:<a class="anchor" aria-label="anchor" href="#duration-distributions"></a>
</h4>
<ul>
<li>
<code>duration_acute</code>, <code>duration_chronic</code>: the
duration of acute and chronic infection</li>
<li>
<code>time_treatment_acute</code>,
<code>time_treatment_chronic</code>: the time until <em>considering</em>
seeking treatment in the acute and chronic stages (more info on
treatment below)</li>
<li>
<code>duration_prophylactic</code>: the duration of post-treatment
prophylaxis</li>
</ul>
</div>
<div class="section level4">
<h4 id="transition-probabilities">transition probabilities:<a class="anchor" aria-label="anchor" href="#transition-probabilities"></a>
</h4>
<ul>
<li>
<code>prob_infection</code>: the probability of becoming infected
given a bite from an infectious mosquito</li>
<li>
<code>prob_acute</code>: the probability of an infection going to
acute stage vs. directly to chronic stage</li>
<li>
<code>prob_AC</code>: the probability of an acute infection going to
chronic stage vs. clearing directly</li>
</ul>
</div>
<div class="section level4">
<h4 id="daily-probabilities">daily probabilities:<a class="anchor" aria-label="anchor" href="#daily-probabilities"></a>
</h4>
<ul>
<li>
<code>detectability_microscopy_acute</code>,
<code>detectability_microscopy_chronic</code>: detectability by
microscopy in the acute and chronic stages</li>
<li>
<code>detectability_PCR_acute</code>,
<code>detectability_PCR_chronic</code>: detectability by polymerase
chain reaction (PCR) in the acute and chronic stages</li>
<li>
<code>infectivity_acute</code>, <code>infectivity_chronic</code>:
onward infectivity of infections in the acute and chronic stages</li>
</ul>
<p>All flexible distributions can be visualised using the function
<code><a href="../reference/plot_flex_distribution.html">plot_flex_distribution()</a></code>, for example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/simplegen_project.html">simplegen_project</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/define_epi_model_parameters.html">define_epi_model_parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_flex_distribution.html">plot_flex_distribution</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"duration_acute"</span><span class="op">)</span></span></code></pre></div>
<p><img src="model_description_files/figure-html/unnamed-chunk-2-1.png" width="480"></p>
<p>In the case of list inputs, all distributions are plotted
together:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/simplegen_project.html">simplegen_project</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/define_epi_model_parameters.html">define_epi_model_parameters</a></span><span class="op">(</span>duration_acute <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">dgeom</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>                                                    <span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">dgeom</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_flex_distribution.html">plot_flex_distribution</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"duration_acute"</span><span class="op">)</span></span></code></pre></div>
<p><img src="model_description_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
</div>
</div>
<div class="section level3">
<h3 id="treatment">Treatment<a class="anchor" aria-label="anchor" href="#treatment"></a>
</h3>
<p>We break treatment down into two elements: first, the time it takes
for the host to be <em>prompted</em> to seek treatment, for example due
to the emergence of clinical features, and second, whether the host
actually seeks treatment at this point in time. The latter is dictated
in the model by a host-specific treatment-seeking probability, <span class="math inline">\(p_i\)</span>, that is defined at birth and stays
with the host for the duration of their life. This treatment-seeking
probability is intended to capture the long-term factors that influence
an individual’s propensity or ability to obtain treatment. These factors
may include distance to the nearest health facility, economic situation,
and a host of other factors. The value of <span class="math inline">\(p_i\)</span> is drawn independently for each host
from a Beta distribution with mean <code>treatment_seeking_mean</code>
and standard deviation <code>treatment_seeking_sd</code>. These
parameters allow the user to define both the mean access to care in the
population and the extent of inequality in access to care.</p>
<p>In parameter inputs we can define both the distribution of duration
of disease (acute and chronic), and the distribution of time until
seeking treatment. These are competing hazards - whichever one of these
occurs first takes precedence. If the disease clears naturally first
then the host does not seek treatment. We also note that treatment can
only be prompted once per infection: if an infection goes through both
acute and then chronic stages then only the acute stage will prompt
treatment (from <code>time_treatment_acute</code>), whereas if an
infection goes directly to chronic then this stage will prompt treatment
(from <code>time_treatment_chronic</code>).</p>
<p>For example, imagine we want to model a population that has good
access to healthcare overall, but with wide disparity between
individuals. We choose parameter values
<code>treatment_seeking_mean = 0.7</code> and
<code>treatment_seeking_sd = 0.2</code>, which we can visualise using
the <code><a href="../reference/plot_treatment_seeking.html">plot_treatment_seeking()</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/simplegen_project.html">simplegen_project</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/define_epi_model_parameters.html">define_epi_model_parameters</a></span><span class="op">(</span>treatment_seeking_mean <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>                              treatment_seeking_sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_treatment_seeking.html">plot_treatment_seeking</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="model_description_files/figure-html/unnamed-chunk-4-1.png" width="480"></p>
<p>The dashed line shows that at a population level there is a 70%
chance of seeking treatment for malaria, but there is also considerable
spread around this value. Each host has a value <span class="math inline">\(p_i\)</span> drawn from this distribution once at
birth. For example, imagine a single individual for which <span class="math inline">\(p_i = 0.1\)</span>. This individual has poor
access to malaria treatment for one reason or another. If this
individual becomes infected <em>and</em> if clinical symptoms occur
<em>before</em> the disease has chance to clear naturally, then this
individual will make the decision to obtain treatment with only a 10%
probability. If they choose not to seek treatment then the disease will
continue until it clears naturally.</p>
<p>Upon treatment, all blood-stage infections are immediately cured, and
the host enters a prophylactic stage in which no new infections are
possible. Liver stage infections are not directly cured, but infections
that leave the liver stage while the host is in the prophylactic stage
are considered immediately cured. Sexual stages are not directly cured,
although the termination of the diseased stage will lead to the eventual
termination of the sexual stage after the appropriate time-lag.</p>
</div>
<div class="section level3">
<h3 id="infectivity-and-mosquitoes">Infectivity and mosquitoes<a class="anchor" aria-label="anchor" href="#infectivity-and-mosquitoes"></a>
</h3>
<p>The onward infectivity of an infection stems from the sexual stage of
the parasite. These are also modelled as going through acute and chronic
stages, which are lagged from the asexual stages by a fixed duration.
For example, take an infection that transitions from liver stage to
acute stage on day 20, then to chronic infection on day 40, then
recovers on day 100. If the gametocyte lag parameter <code>g</code> is
equal to 10 days then the infection will enter the acute infective stage
on day 30, the chronic infective stage on day 50, and will become
uninfective on day 110. The daily infectivity of the acute and chronic
stages can be defined flexibly (see above). If a host carries multiple
infections then the infectivity is taken to be the <em>maximum</em> of
the infectivity of its individual infections.</p>
<p>Mosquitoes exist in three stages: susceptible, latently infected, and
infectious. Upon biting an infectious human host and becoming infected,
they enter the latent stage which has fixed duration <code>v</code> (the
extrinsic incubation period). Upon leaving the latent stage they become
infective to humans. Natural death occurs with constant rate
<code>mu</code> throughout the mosquito lifetime, and every death is
matched with a new birth in the susceptible stage, leading to a constant
mosquito population size <code>M</code> (strictly speaking this is size
of the adult female mosquito population).</p>
</div>
<div class="section level3">
<h3 id="demographics">Demographics<a class="anchor" aria-label="anchor" href="#demographics"></a>
</h3>
<p>The stable age distribution of hosts is calculated from life tables.
If no life table is supplied by the user then values are taken from Mali
demographic data by default. Human deaths are matched by new births,
leading to a constant total human population size. Only natural death is
considered, i.e. malaria does not lead to increased chance of death.</p>
</div>
<div class="section level3">
<h3 id="migration">Migration<a class="anchor" aria-label="anchor" href="#migration"></a>
</h3>
<p>All of the model description above applies to a single
epidemiological unit - a single <em>deme</em>. Human migration is
modelled as a stochastic process in which hosts move between demes.
Currently, only a simple migration model is implemented in which hosts
move between demes according to fixed probabilities that are defined in
a migration matrix.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Bob Verity, Shazia Ruybal, Isobel Routledge, Sophie Berube, Daniel Larremore.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
