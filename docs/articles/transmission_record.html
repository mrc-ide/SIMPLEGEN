<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Transmission Record • SIMPLEGEN</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="The Transmission Record">
<meta property="og:description" content="SIMPLEGEN">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SIMPLEGEN</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Get started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Simulating malaria transmission</li>
    <li>
      <a href="../404.html">TODO - A simple model</a>
    </li>
    <li>
      <a href="../404.html">TODO - Sampling from the population</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Overlaying genetics</li>
    <li>
      <a href="../404.html">TODO - Pruning the transmission record</a>
    </li>
    <li>
      <a href="../404.html">TODO - Pedigrees and relatedness</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    The pipeline
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/what_is_simplegen.html">What is the SIMPLEGEN pipeline?</a>
    </li>
    <li>
      <a href="../articles/transmission_record.html">The transmission record</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Models and calibration
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Overall approach</li>
    <li>
      <a href="../articles/calibration_approach.html">Model development and calibration</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Transmission models</li>
    <li>
      <a href="../articles/model_description.html">The inbuilt transmission model</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Calibration</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/calibration_intro.html">Calibrating the in-built transmission model</a>
        </li>
        <li>
          <a href="../articles/calibration_prev_inc.html">Prevalence, incidence and EIR</a>
        </li>
        <li>
          <a href="../articles/calibration_diagnostics.html">Diagnostics</a>
        </li>
        <li>
          <a href="../articles/calibration_age_inc.html">Age-incidence</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-header">Genetic models</li>
    <li>
      <a href="../404.html">TODO - Description</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Calibration</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../404.html">TODO - Genetic calibration</a>
        </li>
      </ul>
</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Epidemiological data</li>
    <li>
      <a href="../articles/data_prev_inc.html">Prevalence, incidence and EIR</a>
    </li>
    <li>
      <a href="../articles/data_diagnostics.html">Diagnostic sensitivity</a>
    </li>
    <li>
      <a href="../articles/data_age_inc.html">Age-incidence</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Genetic data</li>
    <li>
      <a href="../404.html">TODO - Complexity of infection</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Misc
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/SLiM_review.html">Integrating with SLiM</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/SIMPLEGEN" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The Transmission Record</h1>
                        <h4 data-toc-skip class="author">Bob Verity</h4>
            
            <h4 data-toc-skip class="date">Last updated: 30 Mar
2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/SIMPLEGEN/blob/HEAD/vignettes/transmission_record.Rmd" class="external-link"><code>vignettes/transmission_record.Rmd</code></a></small>
      <div class="hidden name"><code>transmission_record.Rmd</code></div>

    </div>

    
    
<!---
Example comment
-->
<p>In order for a transmission model to plug into the SIMPLEGEN
pipeline, it needs to be able to generate a <em>transmission
record</em>. This vignette describes the format of the transmission
record and explains the logic behind storing information in this
way.</p>
<div class="section level3">
<h3 id="what-is-a-transmission-record">What is a transmission record?<a class="anchor" aria-label="anchor" href="#what-is-a-transmission-record"></a>
</h3>
<p>When we simulate from a transmission model there are typically many
thousands or even millions of events that take place. Some of these
events have the <em>potential</em> to impact the genotypes that we see
in our final sample of infected people. This does not mean they
definitely <em>will</em> impact the observed genotypes, just that that
<em>could</em> in theory impact them. A good example is a host being
bitten by two infectious mosquitoes; this could result in a polyclonal
infection if the mosquitoes carry different genotypes, or it could
result in a monoclonal infection if the mosquitoes carry the same
genotype.</p>
<p>On the other hand, there are many events that cannot impact the
genotypes we see in our final sample. One example would be a human host
dying, either as a result of infection or from natural causes. If a host
dies then by definition it will not make it into our final sample of
malaria-positive people, and so, for our purposes, tracking this event
would be a waste of time and computer memory.</p>
<p>The purpose of the transmission record is <strong>to keep a record of
all events that have the potential to impact the genotypes in the final
sample</strong>. A secondary aim is to do this <strong>in a
computationally efficient way</strong>, retaining only the minimum
information required. A third and final aim is to do this <strong>in a
simple and flexible way</strong>, thereby ensuring that as many models
as possible can access the SIMPLEGEN pipeline.</p>
<p>These aims are slightly at odds with one another - there is no single
file format that will achieve all three aims perfectly. In choosing the
format of the transmission record we have tried to strike a balance that
permits reasonably complex models while still keeping file sizes
relatively small.</p>
</div>
<div class="section level3">
<h3 id="tracking-infections-not-genotypes">Tracking infections, not genotypes<a class="anchor" aria-label="anchor" href="#tracking-infections-not-genotypes"></a>
</h3>
<p>The transmission record works with <em>infections</em>, defined in
this context as <strong>a population of parasites passed between human
host and mosquito at the point of biting</strong>. A single infection
can contain multiple genotypes or a single genotype, i.e. it is a lower
level of granularity than a genotype. At the same time, an infection is
a higher level of granularity than a malaria episode, which could be
made up of multiple infection events. We need this middle ground in
order capture things like superinfection, which doesn’t necessarily
matter from a clinical perspective but can have important consequences
for observed genetic variation.</p>
<p>This brings us to an important assumptions of the SIMPLEGEN
pipeline:</p>
<p><strong>We assume that the genotypes within an infection have no
direct impact on any aspect of transmission.</strong></p>
<p>A classic example would be genotypes separated by neutral mutations,
i.e. those that confer no selective advantage to the parasite. In this
case the frequencies of the different genotypes will drift up and down,
perhaps undergoing strong bottlenecking at times, but crucially the
relative frequencies will have no bearing on the overall progression of
disease (otherwise they would not be <em>neutral</em> mutations).</p>
<p>We can also think of examples that violate this assumption. We can
imagine a model in which a particular allele confers resistance to a
commonly used antimalarial drug, thereby increasing the chance that
infection persists even after treatment. Here, the presence or absence
of the allele directly impacts the progression of the disease, and so we
would need to know genotypes at the point of simulating
transmission.</p>
<p>Although this assumption limits the kinds of models that can use the
SIMPLEGEN pipeline, it does so with good reason. When this assumption is
met it means we can separate out the genetic aspect of simulation from
the epidemiological aspect, which in turn can have huge benefints in
terms of speed and memory requirements. It still leaves the door open to
many research and surveillance questions, for example those that rely on
patterns of neutral genetic variation.</p>
</div>
<div class="section level3">
<h3 id="working-with-infection-ids">Working with infection IDs<a class="anchor" aria-label="anchor" href="#working-with-infection-ids"></a>
</h3>
<p>To make the transmission record we need a way of tracking infections
as they are passed between human hosts and mosquitoes. This can be done
quite easily by using three different types of IDs:</p>
<ol style="list-style-type: decimal">
<li><span style="color: red;">Human IDs</span></li>
<li><span style="color: blue;">Mosquito IDs</span></li>
<li>Infection IDs</li>
</ol>
<p>These IDs are nothing more than numbers that uniquely identify a
given person/mosquito/infection. <strong>Figure 1</strong> gives a
diagram of an infection being passed from a human host to a mosquito.
The human here has ID <span style="color: red;">21</span>, the mosquito
has ID <span style="color: blue;">33</span>, and the infection IDs are
shown inside the small circles. The human host initially carries
infection ID 1, which then becomes infection ID 2 when it is passed to
the mosquito. We can say that infection 2 is the <em>child</em> of
infection 1, and likewise infection 1 is the <em>parent</em> of
infection 2. There is nothing special ocurring biologically when we move
from infection ID 1 to 2, this is just how we label events.</p>
<img src="https://raw.githubusercontent.com/mrc-ide/SIMPLEGEN/develop/R_ignore/images/transmission_record_single.png" style="width:50%"><font size="2">
<figcaption><strong>Figure 1</strong> Example of IDs tracking an infection passing
from human to mosquito.
</figcaption><p></p></font>
<p>A more complex example is given in <strong>Figure 2</strong>. Here we
have several chains of transmission going between human hosts and
mosquitoes.</p>
<img src="https://raw.githubusercontent.com/mrc-ide/SIMPLEGEN/develop/R_ignore/images/transmission_record.png" style="width:50%"><font size="2">
<figcaption><strong>Figure 2</strong> Diagram of infections passing between human
hosts and mosquitoes.
</figcaption><p></p></font>
<p>There are several things to note from this diagram:</p>
<ul>
<li><p>Every infection has a unique ID, even infections that are
children of the same parent. For example, infections 3 and 4 are both
children of infection 1, but they have different IDs to distinguish them
from one another (they are different populations of parasites).</p></li>
<li><p>Both humans and mosquitoes can be infected multiple times. In
this example human <span style="color: red;">25</span> picks up
infections from two different mosquitoes, and similarly mosquito <span style="color: blue;">35</span> picks up infections from two different
humans. There is no limit imposed by the transmission record on the
number of infections a human/mosquito can receive.</p></li>
<li><p>An infection can have a single parent or multiple parents. In
this example infection 12 is the child of parents 8 and 9. This does not
mean anything in terms of genotypes, at this stage we are just tracking
which infections were present at the time of the mosquito bite. For
example, it might be the case that due to bottlenecking all the
genotypes in infection 12 eventualy end up coming from infection 8, but
this doesn’t matter to us at this stage.</p></li>
</ul>
<p>This method of tracking infections is simple, yet rich enough to
capture some important dynamics such as human and mosquito
superinfection. It leaves the door open to different types of genetic
model later on.</p>
</div>
<div class="section level3">
<h3 id="the-transmission-record">The transmission record<a class="anchor" aria-label="anchor" href="#the-transmission-record"></a>
</h3>
<p>Now that we have established some rules for how infections are passed
between humans and mosquitoes, we can think about how to encode this
information. <strong>Figure 3</strong> gives the exact same information
as <strong>Figure 2</strong>, but in the form of a table:</p>
<img src="https://raw.githubusercontent.com/mrc-ide/SIMPLEGEN/develop/R_ignore/images/transmission_record_table.png" style="width:70%"><font size="2">
<figcaption><strong>Figure 3</strong> Example of a basic transmission record.
</figcaption><p></p></font>
<p>Again, there a few things to note from this table:</p>
<ul>
<li><p>The <em>time</em> column tells us when the infectious bite
happened. In this example we have events spread over five sequential
days, but there is no need for time to be sequential like this.</p></li>
<li><p>The <em>event</em> column tells us whether this row represents a
human being infected from a mosquito (event = 1) or a mosquito being
infected from a human (event = 2). These are the only two possible
events; if we wanted to represent parasites being passed in both
directions in a single bite we would need to use two rows.</p></li>
<li><p>In some cases we might want to represent a new infection entering
the population without a parent; for example an infection imported from
outside our study population. In this case a value -1 can be used for
both the infection ID and the human/mosquito ID. In the example above we
start with two infected humans (<span style="color: red;">21</span> and
<span style="color: red;">22</span>), and so these are encoded in the
table as two new infections without parents.</p></li>
</ul>
<p>This is the most basic format of the transmission record. <strong>Any
simulation model that is capable of producing a record like the one
above can plug into the SIMPLEGEN pipeline.</strong></p>
<p>There are also some optional columns that can be used to add depth to
the transmission record. The first is a record of parasite densities. In
the example above it appears that infections within a host/mosquito are
equally important, for example infection IDs 8 and 9 within host <span style="color: red;">25</span> are given equal weight, but in reality one
of these infections might contribute far more to the total parasite
load. We can accommodate this by storing the relative parasite densities
of each infection in an additional <em>parent_infection_density</em>
column. The values in this column correspond directly to the infections
in the <em>parent_infection_ID</em> column, so if there are three values
in one column then there must be three values in the other. Some genetic
models might make use of this information while others might not.</p>
<p>The second optional field is the <em>deme</em>. This stores the deme
(i.e. subpopulation) in which the human and mosquito reside at the time
of the bite. For some models this information will be very important,
for example if we want to assume some sort of spatial structure in our
model with each location having a different mix of starting allele
frequencies. <strong>Figure 4</strong> gives an example of a
transmission record with these optional extra columns:</p>
<img src="https://raw.githubusercontent.com/mrc-ide/SIMPLEGEN/develop/R_ignore/images/transmission_record_table2.png" style="width:90%"><font size="2">
<figcaption><strong>Figure 4</strong> Example of a transmission record with optional
extra columns.
</figcaption><p></p></font>
<p>Some things to note from this table:</p>
<ul>
<li><p>Parasite densities are taken as relative values, meaning they can
be proportions or absolute numbers.</p></li>
<li><p>Demes are integer numbers. In this example host <span style="color: red;">21</span> moves demes between their first and second
mosquito bite.</p></li>
</ul>
<p>The format of the transmission record is a comma-separated file
(.csv), meaning it can be opened and browsed manually if needed. The
next step in the pipeline will be to prune this record down, which can
reduce file sizes dramatically.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Bob Verity, Shazia Ruybal, Isobel Routledge, Sophie Berube, Daniel Larremore.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
